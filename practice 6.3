const express = require('express');
const mongoose = require('mongoose');
const dotenv = require('dotenv');
const bcrypt = require('bcryptjs');
const jwt = require('jsonwebtoken');
const cors = require('cors');

dotenv.config();
const app = express();
app.use(express.json());
app.use(cors());

mongoose.connect(process.env.MONGO_URI).then(()=>console.log('db')).catch(e=>console.error(e));

const userSchema = new mongoose.Schema({
  username:{type:String,required:true,unique:true},
  password:{type:String,required:true},
  balance:{type:Number,default:0}
},{timestamps:true});
const transferSchema = new mongoose.Schema({
  idempotencyKey:{type:String,required:true,unique:true},
  from:{type:mongoose.Schema.Types.ObjectId,ref:'User',required:true},
  to:{type:mongoose.Schema.Types.ObjectId,ref:'User',required:true},
  amount:{type:Number,required:true},
  status:{type:S
